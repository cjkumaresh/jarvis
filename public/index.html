<!DOCTYPE html>
<html>   
    <head>
        <title>PAM3</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <link rel="stylesheet" href="app/css/bootstrap.min.css">
        <link rel="stylesheet" href="app/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="app/css/font-awesome.min.css">
        <link rel="stylesheet" href="app/css/index.css">
                
        <script data-main="app/app" src="app/lib/require.js"></script>    
        <script type="text/template" id="title_template">        
             <h1>Welcome to <%=app_name %></h1>
             <img id="image"></img>
        </script>
        <script type="text/template" id="file-system-view-template">
            <h4>Location <%=path %></h4>
            <ul>
                <% _.each(files, function(file) { %>
                    <li><i class="fa fa-folder"></i><a href="#<%= location %><%= file %>"><label><%= file %></label></a></li>
                <% }); %>
            </ul>
        </script>
        <script>
            window.AudioContext = window.AudioContext||window.webkitAudioContext;
            context = new AudioContext();
            function loadSound() {
                var request = new XMLHttpRequest();
                request.open("GET", "/music", true); 
                request.responseType = "arraybuffer"; 

                request.onload = function() {
                    var Data = request.response;
                    processAudio(Data);
                };

                request.send();
                }
            function processAudio(Data) {
                source = context.createBufferSource(); // Create Sound Source
                context.decodeAudioData(Data, function(buffer) {
                    source.buffer = buffer;
                    source.connect(context.destination); 
                    source.start(context.currentTime);
                });
            } 
            //loadSound();
            </script>
        <script type="text/template" id="media-file-view-template">
                <% if(extn == '.mp3') { %>
                    <%= processAudio(src) %>/> 
                <% } else if (extn == '.jpg') { %>
                    <img class="col-sm-12" src="data:image/jpg;base64,<%= src %>"/>
                <% } else if (extn == '.mp4') { %>
                    <video src="<%= src %>"/>
                <% } else if (extn == '.txt') { %>
                    <div><%= src %></div>                        
                <% } else { %>
                    <div>File Format doesn't supported</div>
                <% } %>    
                        
        </script>
    </head>

    <body class="container">
        <div id="app-name"></div>
        <a href="#/home"><h4>Browse Files and Folders</h4></a>
        <div id="file-system-view"></div>
        <div id="media-view"></div>
    </body>
    <script data-main="app/app" src="app/lib/jquery.js"></script>        
    <script data-main="app/app" src="app/lib/bootstrap.min.js"></script>        
</html>
    